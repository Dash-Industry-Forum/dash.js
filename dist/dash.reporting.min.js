!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(b.dashjs||(b.dashjs={})).MetricsReporting=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b,c,d){var e=g(d);!e[a]&&b&&(e[a]={instance:b,override:c})}function b(a,b){for(var c in j){var d=j[c];if(d.context===a&&d.name===b)return d.instance}return null}function c(a,b,c){for(var d in j){var e=j[d];if(e.context===a&&e.name===b)return void(j[d].instance=c)}j.push({name:b,context:a,instance:c})}function d(a){return function(b){return void 0===b&&(b={}),{create:function(){return f(a.__dashjs_factory_name,a.apply({context:b},arguments),b,arguments)}}}}function e(a){return function(c){var d=void 0;return void 0===c&&(c={}),{getInstance:function(){return d||(d=b(c,a.__dashjs_factory_name)),d||(d=f(a.__dashjs_factory_name,a.apply({context:c},arguments),c,arguments),j.push({name:a.__dashjs_factory_name,context:c,instance:d})),d}}}}function f(a,b,c,d){var e=g(c),f=e[a];if(f){var i=f.instance;if(!f.override)return i.apply({context:c,factory:h},d);i=i.apply({context:c,factory:h,parent:b},d);for(var j in i)b.hasOwnProperty(j)&&(b[j]=i[j])}return b}function g(a){var b=void 0;return i.forEach(function(c){c===a&&(b=c)}),b||(b=i.push(a)),b}var h=void 0,i=[],j=[];return h={extend:a,getSingletonInstance:b,setSingletonInstance:c,getSingletonFactory:e,getClassFactory:d}}();c["default"]=d,b.exports=c["default"]},{}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a("./EventsBase.js"),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.AST_IN_FUTURE="astinfuture",this.BUFFERING_COMPLETED="bufferingCompleted",this.BUFFER_CLEARED="bufferCleared",this.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",this.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",this.BYTES_APPENDED="bytesAppended",this.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",this.CHUNK_APPENDED="chunkAppended",this.CURRENT_TRACK_CHANGED="currenttrackchanged",this.DATA_UPDATE_COMPLETED="dataUpdateCompleted",this.DATA_UPDATE_STARTED="dataUpdateStarted",this.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",this.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",this.INITIALIZATION_LOADED="initializationLoaded",this.INIT_FRAGMENT_LOADED="initFragmentLoaded",this.INIT_REQUESTED="initRequested",this.INTERNAL_MANIFEST_LOADED="manifestLoaded",this.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",this.LOADING_COMPLETED="loadingCompleted",this.LOADING_PROGRESS="loadingProgress",this.MANIFEST_UPDATED="manifestUpdated",this.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",this.QUALITY_CHANGED="qualityChanged",this.QUOTA_EXCEEDED="quotaExceeded",this.REPRESENTATION_UPDATED="representationUpdated",this.SEGMENTS_LOADED="segmentsLoaded",this.SOURCEBUFFER_APPEND_COMPLETED="sourceBufferAppendCompleted",this.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",this.STREAMS_COMPOSED="streamsComposed",this.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",this.STREAM_COMPLETED="streamCompleted",this.STREAM_INITIALIZED="streaminitialized",this.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",this.TIMED_TEXT_REQUESTED="timedTextRequested",this.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",this.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",this.XLINK_ALL_ELEMENTS_LOADED="xlinkAllElementsLoaded",this.XLINK_ELEMENT_LOADED="xlinkElementLoaded",this.XLINK_READY="xlinkReady"}return f(b,a),b}(i["default"]);c["default"]=j,b.exports=c["default"]},{"./EventsBase.js":4}],3:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a("./CoreEvents.js"),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).apply(this,arguments)}return f(b,a),b}(i["default"]),k=new j;c["default"]=k,b.exports=c["default"]},{"./CoreEvents.js":2}],4:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,[{key:"extend",value:function(a,b){if(a){var c=b?b.override:!1,d=b?b.publicOnly:!1;for(var e in a)!a.hasOwnProperty(e)||this[e]&&!c||d&&-1===a[e].indexOf("public_")||(this[e]=a[e])}}}]),a}();c["default"]=f,b.exports=c["default"]},{}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a("../core/events/EventsBase.js"),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.BUFFER_EMPTY="bufferstalled",this.BUFFER_LOADED="bufferloaded",this.ERROR="error",this.LOG="log",this.MANIFEST_LOADED="manifestloaded",this.METRICS_CHANGED="metricschanged",this.METRIC_CHANGED="metricchanged",this.METRIC_ADDED="metricadded",this.METRIC_UPDATED="metricupdated",this.PERIOD_SWITCH_COMPLETED="streamswitchcompleted",this.PERIOD_SWITCH_STARTED="streamswitchstarted",this.STREAM_INITIALIZED="streaminitialized",this.TEXT_TRACKS_ADDED="alltexttracksadded",this.TEXT_TRACK_ADDED="texttrackadded",this.CAN_PLAY="canPlay",this.PLAYBACK_ENDED="playbackEnded",this.PLAYBACK_ERROR="playbackError",this.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",this.PLAYBACK_PAUSED="playbackPaused",this.PLAYBACK_PLAYING="playbackPlaying",this.PLAYBACK_PROGRESS="playbackProgress",this.PLAYBACK_RATE_CHANGED="playbackRateChanged",this.PLAYBACK_SEEKED="playbackSeeked",this.PLAYBACK_SEEKING="playbackSeeking",this.PLAYBACK_STARTED="playbackStarted",this.PLAYBACK_TIME_UPDATED="playbackTimeUpdated"}return f(b,a),b}(i["default"]),k=new j;c["default"]=k,b.exports=c["default"]},{"../core/events/EventsBase.js":4}],6:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(a){return f=(0,g["default"])(d).getInstance({eventBus:a.eventBus,metricsModel:a.metricsModel}),(0,k["default"])(d).create(a)}function b(){return(0,o["default"])(d).getInstance()}function c(){return(0,m["default"])(d).getInstance()}var d=this.context,e=void 0,f=void 0;return e={createMetricsReporting:a,getReportingFactory:b,getMetricsHandlerFactory:c}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./utils/DVBErrorsTranslator.js"),g=d(f),h=a("./MetricsReportingEvents.js"),i=d(h),j=a("./controllers/MetricsCollectionController.js"),k=d(j),l=a("./metrics/MetricsHandlerFactory.js"),m=d(l),n=a("./reporting/ReportingFactory.js"),o=d(n),p=a("../../core/FactoryMaker.js"),q=d(p);e.__dashjs_factory_name="MetricsReporting";var r=q["default"].getClassFactory(e);r.events=i["default"],c["default"]=r,b.exports=c["default"]},{"../../core/FactoryMaker.js":1,"./MetricsReportingEvents.js":7,"./controllers/MetricsCollectionController.js":8,"./metrics/MetricsHandlerFactory.js":13,"./reporting/ReportingFactory.js":18,"./utils/DVBErrorsTranslator.js":20}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a("../../core/events/EventsBase.js"),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",this.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer"}return f(b,a),b}(i["default"]),k=new j;c["default"]=k,b.exports=c["default"]},{"../../core/events/EventsBase.js":4}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(b){if(!b.error){var c=Object.keys(e),d=(0,i["default"])(f).getInstance({dashManifestModel:a.dashManifestModel}).getMetrics(b.manifest);d.forEach(function(b){var d=JSON.stringify(b);if(e.hasOwnProperty(d))c.splice(d,1);else try{var h=(0,g["default"])(f).create(a);h.initialize(b),e[d]=h}catch(i){}}),c.forEach(function(a){e[a].reset(),delete e[a]}),h.trigger(m["default"].METRICS_INITIALISATION_COMPLETE)}}function c(){Object.keys(e).forEach(function(a){e[a].reset()}),e={}}function d(){h.on(o["default"].MANIFEST_UPDATED,b),h.on(o["default"].STREAM_TEARDOWN_COMPLETE,c)}var e={},f=this.context,h=a.eventBus;return d(),{}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./MetricsController.js"),g=d(f),h=a("../utils/ManifestParsing.js"),i=d(h),j=a("../../../core/FactoryMaker.js"),k=d(j),l=a("../MetricsReportingEvents.js"),m=d(l),n=a("../../../core/events/Events.js"),o=d(n);e.__dashjs_factory_name="MetricsCollectionController",c["default"]=k["default"].getClassFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"../../../core/events/Events.js":3,"../MetricsReportingEvents.js":7,"../utils/ManifestParsing.js":22,"./MetricsController.js":9}],9:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(b){try{f=(0,i["default"])(h).create({mediaElement:a.mediaElement}),f.initialize(b.Range),e=(0,k["default"])(h).create({log:a.log}),e.initialize(b.Reporting,f),d=(0,m["default"])(h).create({log:a.log,eventBus:a.eventBus}),d.initialize(b.metrics,e)}catch(g){throw c(),g}}function c(){d&&d.reset(),e&&e.reset(),f&&f.reset()}var d=void 0,e=void 0,f=void 0,g=void 0,h=this.context;return g={initialize:b,reset:c}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/FactoryMaker.js"),g=d(f),h=a("./RangeController.js"),i=d(h),j=a("./ReportingController.js"),k=d(j),l=a("./MetricsHandlersController.js"),m=d(l);e.__dashjs_factory_name="MetricsController",c["default"]=g["default"].getClassFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"./MetricsHandlersController.js":10,"./RangeController.js":11,"./ReportingController.js":12}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(a){e.forEach(function(b){b.handleNewMetric(a.metric,a.value,a.mediaType)})}function c(a,c){a.split(",").forEach(function(a,b,d){var f;if(-1!==a.indexOf("(")&&-1===a.indexOf(")")){var g=d[b+1];g&&-1===g.indexOf("(")&&-1!==g.indexOf(")")&&(a+=","+g,delete d[b+1])}f=j.create(a,c),f&&e.push(f)}),i.on(k["default"].METRIC_ADDED,b,f),i.on(k["default"].METRIC_UPDATED,b,f)}function d(){i.off(k["default"].METRIC_ADDED,b,f),i.off(k["default"].METRIC_UPDATED,b,f),e.forEach(function(a){return a.reset()}),e=[]}var e=[],f=void 0,h=this.context,i=a.eventBus,j=(0,g["default"])(h).getInstance({log:a.log,eventBus:a.eventBus});return f={initialize:c,reset:d}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../metrics/MetricsHandlerFactory.js"),g=d(f),h=a("../../../core/FactoryMaker.js"),i=d(h),j=a("../../MediaPlayerEvents.js"),k=d(j);e.__dashjs_factory_name="MetricsHandlersController",c["default"]=i["default"].getClassFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"../../MediaPlayerEvents.js":5,"../metrics/MetricsHandlerFactory.js":13}],11:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(a){a&&a.length&&(a.forEach(function(a){var b=a.starttime,c=b+a.duration;j.add(b,c)}),f=!!a[0]._useWallClockTime)}function c(){j.clear()}function d(){j=(0,i["default"])(g).create()}function e(){var a,b=j.length;if(!b)return!0;a=f?(new Date).getTime()/1e3:k.currentTime;for(var c=0;b>c;c+=1){var d=j.start(c),e=j.end(c);if(a>=d&&e>a)return!0}return!1}var f=!1,g=this.context,h=void 0,j=void 0,k=a.mediaElement;return h={initialize:b,reset:c,isEnabled:e},d(),h}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/FactoryMaker.js"),g=d(f),h=a("../../utils/CustomTimeRanges.js"),i=d(h);e.__dashjs_factory_name="RangeController",c["default"]=g["default"].getClassFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"../../utils/CustomTimeRanges.js":29}],12:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(a,b){a.some(function(a){var c=g.create(a,b);return c?(e.push(c),!0):void 0})}function c(){e.forEach(function(a){return a.reset()}),e=[]}function d(a,b){e.forEach(function(c){return c.report(a,b)})}var e=[],f=void 0,g=(0,i["default"])(this.context).getInstance({log:a.log});return f={initialize:b,reset:c,report:d}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/FactoryMaker.js"),g=d(f),h=a("../reporting/ReportingFactory.js"),i=d(h);e.__dashjs_factory_name="ReportingController",c["default"]=g["default"].getClassFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"../reporting/ReportingFactory.js":18}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(b,c){var d,e=b.match(g);if(e){try{d=j[e[1]](h).create({eventBus:a.eventBus}),d.initialize(e[1],c,e[3],e[5])}catch(i){d=null,f("MetricsHandlerFactory: Could not create handler for type "+e[1]+" with args "+e[3]+", "+e[5]+" ("+i.message+")")}return d}}function c(a,b){j[a]=b}function d(a){delete j[a]}var e=void 0,f=a.log,g=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,h=this.context,j={BufferLevel:i["default"],DVBErrors:k["default"],HttpList:m["default"],PlayList:o["default"],RepSwitchList:o["default"],TcpList:o["default"]};return e={create:b,register:c,unregister:d}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/FactoryMaker.js"),g=d(f),h=a("./handlers/BufferLevelHandler.js"),i=d(h),j=a("./handlers/DVBErrorsHandler.js"),k=d(j),l=a("./handlers/HttpListHandler.js"),m=d(l),n=a("./handlers/GenericMetricHandler.js"),o=d(n);e.__dashjs_factory_name="MetricsHandlerFactory",c["default"]=g["default"].getSingletonFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"./handlers/BufferLevelHandler.js":14,"./handlers/DVBErrorsHandler.js":15,"./handlers/GenericMetricHandler.js":16,"./handlers/HttpListHandler.js":17}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(){try{return Object.keys(o).map(function(a){return o[a]}).reduce(function(a,b){return a.level<b.level?a:b})}catch(a){return}}function b(){var b=a();b&&l!==b.t&&(l=b.t,g.report(j,b))}function c(a,c,d){c&&(h=n.validateN(d),g=c,j=n.reconstructFullMetricName(a,d),k=setInterval(b,h))}function d(){clearInterval(k),k=null,h=0,g=null,l=null}function e(a,b,c){"BufferLevel"===a&&(o[c]=b)}var f=void 0,g=void 0,h=void 0,j=void 0,k=void 0,l=void 0,m=this.context,n=(0,i["default"])(m).getInstance(),o=[];return f={initialize:c,reset:d,handleNewMetric:e}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../../core/FactoryMaker.js"),g=d(f),h=a("../../utils/HandlerHelpers.js"),i=d(h);e.__dashjs_factory_name="BufferLevelHandler",c["default"]=g["default"].getClassFactory(e),b.exports=c["default"]},{"../../../../core/FactoryMaker.js":1,"../../utils/HandlerHelpers.js":21}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(){h.off(i["default"].METRICS_INITIALISATION_COMPLETE,b,this),h.trigger(i["default"].BECAME_REPORTING_PLAYER)}function c(a,c){c&&(g=c,h.on(i["default"].METRICS_INITIALISATION_COMPLETE,b,this))}function d(){g=null}function e(a,b){"DVBErrors"===a&&g&&g.report(a,b)}var f=void 0,g=void 0,h=a.eventBus;return f={initialize:c,reset:d,handleNewMetric:e}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../../core/FactoryMaker.js"),g=d(f),h=a("../../MetricsReportingEvents.js"),i=d(h);c["default"]=g["default"].getClassFactory(e),b.exports=c["default"]},{"../../../../core/FactoryMaker.js":1,"../../MetricsReportingEvents.js":7}],16:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(a,b){e=a,f=b}function b(){f=null,e=void 0}function c(a,b){a===e&&f&&f.report(e,b)}var d=void 0,e=void 0,f=void 0;return d={initialize:a,reset:b,handleNewMetric:c}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../../core/FactoryMaker.js"),g=d(f);e.__dashjs_factory_name="GenericMetricHandler",c["default"]=g["default"].getClassFactory(e),b.exports=c["default"]},{"../../../../core/FactoryMaker.js":1}],17:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(){var a=l;a.length&&f&&f.report(j,a),l=[]}function b(b,c,d,e){c&&(g=m.validateN(d),f=c,e&&e.length&&(h=e),j=m.reconstructFullMetricName(b,d,e),k=setInterval(a,g))}function c(){clearInterval(k),k=null,g=null,h=null,l=[],f=null}function d(a,b){"HttpList"===a&&(h&&h!==b.type||l.push(b))}var e=void 0,f=void 0,g=void 0,h=void 0,j=void 0,k=void 0,l=[],m=(0,i["default"])(this.context).getInstance();return e={initialize:b,reset:c,handleNewMetric:d}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../../core/FactoryMaker.js"),g=d(f),h=a("../../utils/HandlerHelpers.js"),i=d(h);e.__dashjs_factory_name="HttpListHandler",c["default"]=g["default"].getClassFactory(e),b.exports=c["default"]},{"../../../../core/FactoryMaker.js":1,"../../utils/HandlerHelpers.js":21}],18:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(a,b){var c;try{c=e[a.schemeIdUri](f).create(),c.initialize(a,b)}catch(d){c=null,g("ReportingFactory: could not create Reporting with schemeIdUri "+a.schemeIdUri+" ("+d.message+")")}return c}function c(a,b){e[a]=b}function d(a){delete e[a]}var e={"urn:dvb:dash:reporting:2014":i["default"]},f=this.context,g=a.log,h=void 0;return h={create:b,register:c,unregister:d}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/FactoryMaker.js"),g=d(f),h=a("./reporters/DVBReporting.js"),i=d(h);e.__dashjs_factory_name="ReportingFactory",c["default"]=g["default"].getSingletonFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"./reporters/DVBReporting.js":19}],19:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(a,b,c){var d=new XMLHttpRequest,e=function(){var a=q.indexOf(d);-1!==a&&(q.splice(a,1),d.status>=200&&d.status<300?b&&b():c&&c())};q.push(d);try{d.open("GET",a),d.onloadend=e,d.onerror=e,d.send()}catch(f){d.onerror()}}function b(b,c){Array.isArray(c)||(c=[c]),l&&o.isEnabled()&&c.forEach(function(c){var d=g.serialise(c);j&&"DVBErrors"!==b&&(d="metricname="+b+"&"+d),d=n+"?"+d,a(d,null,function(){l=!1})})}function c(a,b){var c;if(o=b,n=a["dvb:reportingUrl"],!n)throw new Error("required parameter missing (dvb:reportingUrl)");m||(c=a["dvb:probability"]||a["dvb:priority"]||0,c&&(1e3===c||c/1e3>=h.random())&&(l=!0),m=!0)}function d(){p||(q.forEach(function(a){return a.abort()}),q=[]),m=!1,l=!1,n=null,o=null}var e=void 0,f=this.context,g=(0,i["default"])(f).getInstance(),h=(0,k["default"])(f).getInstance(),j=!0,l=!1,m=!1,n=null,o=null,p=!0,q=[];return e={report:b,initialize:c,reset:d}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../../core/FactoryMaker.js"),g=d(f),h=a("../../utils/MetricSerialiser.js"),i=d(h),j=a("../../utils/RNG.js"),k=d(j);e.__dashjs_factory_name="DVBReporting",c["default"]=g["default"].getClassFactory(e),b.exports=c["default"]},{"../../../../core/FactoryMaker.js":1,"../../utils/MetricSerialiser.js":23,"../../utils/RNG.js":24}],20:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(a){a.error||(q=a.manifest)}function c(){h({errorcode:g["default"].BECAME_REPORTER})}function d(a){(0===a.responsecode||a.responsecode>=400||a.responsecode<100||a.responsecode>=600)&&h({errorcode:a.responsecode||g["default"].CONNECTION_ERROR,url:a.url,terror:a.tresponse})}function e(a){switch(a.metric){case"HttpList":d(a.value)}}function f(a){var b,c=a.error?a.error.code:0;switch(c){case MediaError.MEDIA_ERR_NETWORK:b=g["default"].CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:b=g["default"].CORRUPT_MEDIA_OTHER;break;default:return}h({errorcode:b})}function h(a){var b=new g["default"];if(q){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);b.mpdurl||(b.mpdurl=q.originalUrl||q.url),b.servicelocation||(b.servicelocation=q.BaseURL.serviceLocation),b.terror||(b.terror=new Date),p.addDVBErrors(b)}}function j(){o.on(i["default"].MANIFEST_UPDATED,b,n),o.on(k["default"].METRIC_ADDED,e,n),o.on(k["default"].METRIC_UPDATED,e,n),o.on(k["default"].PLAYBACK_ERROR,f,n),o.on(m["default"].BECAME_REPORTING_PLAYER,c,n)}function l(){o.off(i["default"].MANIFEST_UPDATED,b,n),o.off(k["default"].METRIC_ADDED,e,n),o.off(k["default"].METRIC_UPDATED,e,n),o.off(k["default"].PLAYBACK_ERROR,f,n),o.off(m["default"].BECAME_REPORTING_PLAYER,c,n)}var n=void 0,o=a.eventBus,p=a.metricsModel,q=void 0;return n={initialise:j,reset:l},j(),n}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../vo/DVBErrors.js"),g=d(f),h=a("../../../core/events/Events.js"),i=d(h),j=a("../../MediaPlayerEvents.js"),k=d(j),l=a("../MetricsReportingEvents.js"),m=d(l),n=a("../../../core/FactoryMaker.js"),o=d(n);e.__dashjs_factory_name="DVBErrorsTranslator",c["default"]=o["default"].getSingletonFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"../../../core/events/Events.js":3,"../../MediaPlayerEvents.js":5,"../MetricsReportingEvents.js":7,"../vo/DVBErrors.js":25}],21:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){return{reconstructFullMetricName:function(a,b,c){var d=a;return b&&(d+="("+b,c&&c.length&&(d+=","+c),d+=")"),d},validateN:function(a){if(!a)throw"missing n";if(isNaN(a))throw"n is NaN";if(0>a)throw"n must be positive";return a}}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/FactoryMaker.js"),g=d(f);e.__dashjs_factory_name="HandlerHelpers",c["default"]=g["default"].getSingletonFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1}],22:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(a,b,c){var d,f,g=e.getMpd(a),h=0;return b?h=g.availabilityStartTime.getTime()/1e3:(d=this.getRegularPeriods(a,g),d.length&&(h=d[0].start)),f=h,c&&c.hasOwnProperty("starttime")&&(f+=c.starttime),f}function c(a){var c=[];return a.Metrics_asArray&&a.Metrics_asArray.forEach(function(d){var f=new g["default"],h=e.getIsDynamic(a);d.hasOwnProperty("metrics")&&(f.metrics=d.metrics,d.Range_asArray&&d.Range_asArray.forEach(function(c){var d=new i["default"];d.starttime=b(a,h,c),c.hasOwnProperty("duration")?d.duration=c.duration:d.duration=e.getDuration(a),d._useWallClockTime=h,f.Range.push(d)}),d.Reporting_asArray&&(d.Reporting_asArray.forEach(function(a){var b=new k["default"];if(a.hasOwnProperty("schemeIdUri")){b.schemeIdUri=a.schemeIdUri;for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);f.Reporting.push(b)}}),c.push(f)))}),c}var d=void 0,e=a.dashManifestModel;return d={getMetrics:c}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../vo/Metrics.js"),g=d(f),h=a("../vo/Range.js"),i=d(h),j=a("../vo/Reporting.js"),k=d(j),l=a("../../../core/FactoryMaker.js"),m=d(l);e.__dashjs_factory_name="ManifestParsing",c["default"]=m["default"].getSingletonFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1,"../vo/Metrics.js":26,"../vo/Range.js":27,"../vo/Reporting.js":28}],23:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(b){var c,d,e=[],f=[];for(c in b)if(b.hasOwnProperty(c)&&0!==c.indexOf("_")){if(d=b[c],(void 0===d||null===d)&&(d=""),Array.isArray(d)){if(!d.length)continue;f=[],d.forEach(function(b){var c="Object"!==Object.prototype.toString.call(b).slice(8,-1);f.push(c?b:a(b))}),d=encodeURIComponent(f.join(","))}else"string"==typeof d?d=encodeURIComponent(d):d instanceof Date?d=d.toISOString():"number"==typeof d&&(d=Math.round(d));e.push(c+"="+d)}return e.join("&")}return{serialise:a}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/FactoryMaker.js"),g=d(f);e.__dashjs_factory_name="MetricSerialiser",c["default"]=g["default"].getSingletonFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1}],24:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(){c&&(g||(g=new d(f)),c.getRandomValues(g),h=0)}function b(b,d){var f;return b||(b=0),d||(d=1),c?(h===g.length&&a(),f=g[h]/e,h+=1):f=Math.random(),f*(d-b)+b}var c=window.crypto||window.msCrypto,d=Uint32Array,e=Math.pow(2,8*d.BYTES_PER_ELEMENT)-1,f=10,g=void 0,h=void 0,i=void 0;return i={random:b},a(),i}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/FactoryMaker.js"),g=d(f);e.__dashjs_factory_name="RNG",c["default"]=g["default"].getSingletonFactory(e),b.exports=c["default"]},{"../../../core/FactoryMaker.js":1}],25:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function f(){d(this,f),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};e.SSL_CONNECTION_FAILED_PREFIX="SSL",e.DNS_RESOLUTION_FAILED="C00",e.HOST_UNREACHABLE="C01",e.CONNECTION_REFUSED="C02",e.CONNECTION_ERROR="C03",e.CORRUPT_MEDIA_ISOBMFF="M00",e.CORRUPT_MEDIA_OTHER="M01",e.BASE_URL_CHANGED="F00",e.BECAME_REPORTER="S00",c["default"]=e,b.exports=c["default"]},{}],26:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function f(){d(this,f),this.metrics="",this.Range=[],this.Reporting=[]};c["default"]=e,b.exports=c["default"]},{}],27:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function f(){d(this,f),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};c["default"]=e,b.exports=c["default"]},{}],28:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function f(){d(this,f),this.schemeIdUri="",this.value=""};c["default"]=e,b.exports=c["default"]},{}],29:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(a,b){var c=0;for(c=0;c<this.customTimeRangeArray.length&&a>this.customTimeRangeArray[c].start;c++);for(this.customTimeRangeArray.splice(c,0,{start:a,end:b}),c=0;c<this.customTimeRangeArray.length-1;c++)this.mergeRanges(c,c+1)&&c--;this.length=this.customTimeRangeArray.length}function b(){this.customTimeRangeArray=[],this.length=0}function c(a,b){for(var c=0;c<this.customTimeRangeArray.length;c++)if(a<=this.customTimeRangeArray[c].start&&b>=this.customTimeRangeArray[c].end)this.customTimeRangeArray.splice(c,1),c--;else{if(a>this.customTimeRangeArray[c].start&&b<this.customTimeRangeArray[c].end){this.customTimeRangeArray.splice(c+1,0,{start:b,end:this.customTimeRangeArray[c].end}),this.customTimeRangeArray[c].end=a;break}a>this.customTimeRangeArray[c].start&&a<this.customTimeRangeArray[c].end?this.customTimeRangeArray[c].end=a:b>this.customTimeRangeArray[c].start&&b<this.customTimeRangeArray[c].end&&(this.customTimeRangeArray[c].start=b)}this.length=this.customTimeRangeArray.length}function d(a,b){var c=this.customTimeRangeArray[a],d=this.customTimeRangeArray[b];return c.start<=d.start&&d.start<=c.end&&c.end<=d.end?(c.end=d.end,this.customTimeRangeArray.splice(b,1),!0):d.start<=c.start&&c.start<=d.end&&d.end<=c.end?(c.start=d.start,this.customTimeRangeArray.splice(b,1),!0):d.start<=c.start&&c.start<=d.end&&c.end<=d.end?(this.customTimeRangeArray.splice(a,1),!0):c.start<=d.start&&d.start<=c.end&&d.end<=c.end?(this.customTimeRangeArray.splice(b,1),!0):!1}function e(a){return this.customTimeRangeArray[a].start}function f(a){return this.customTimeRangeArray[a].end}var g=[],h=0;return{customTimeRangeArray:g,length:h,add:a,clear:b,remove:c,mergeRanges:d,start:e,end:f}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../core/FactoryMaker.js"),g=d(f);e.__dashjs_factory_name="CustomTimeRanges",c["default"]=g["default"].getClassFactory(e),
b.exports=c["default"]},{"../../core/FactoryMaker.js":1}]},{},[6])(6)});
//# sourceMappingURL=dash.reporting.min.js.map